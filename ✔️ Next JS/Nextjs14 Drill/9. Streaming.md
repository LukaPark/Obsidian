
1. **스트리밍**이란 ?
2. **Suspense**와 **==loading.tsx==** 를 사용하여 스트리밍을 구현하는 방법.
3. **로딩 스켈레톤** 이란?
4. **route group** 이란?
5. 앱 내에서 **Suspense** 경계를 배치할 위치.

#suspense: 미결, 미정(상태)

# 스트리밍이란 ?

- 스트리밍은 경로를 더 작은 '청크(chunks)'로 나누고, 준비가 되면 서버에서 클라이언트로 점진적으로 스트리밍 할 수 있는 데이터 전송 기술.
![[Pasted image 20231109142227.png]]

- 스트리밍하면 느린 데이터 요청이 전체 페이지를 차단하는 것을 방지 할 수 있음. => 이를 통해 사용자는 UI가 사용자에게 표시되기 전에 모든 데이터가 로드될 때까지 기다리지 않고, 페이지의 일부를 보고 상호 작용할 수 있음.
- 데이터 가져오기 및 렌더링이 병렬로 시작되므로, 사용자는 UI가 준비되는 과정을 볼 수 있고, 이는 데이터 가져오기 및 렌더링이 순차적으로 시작되어 모든 데이터가 준비될 때까지 UI 렌더링을 차단하는 폭포식 접근 과는 차별 됨.

![[Pasted image 20231109142505.png]]

*스트리밍은 각 구성 요소가 덩어리로 간주될 수 있으므로, React의 구성 요소 모델과 잘 작동합니다.*

- 스트리밍을 구현하는 방법.
	1. 페이지 수준에서 loading.tsx 를 이용
	2. 특정 컴포넌트에서 Suspense 컴포넌트 사용.

* loading.tsx는 Suspense를 기반으로 구축된 특수 Next.js 페이지로,
* 페이지 콘텐츠가 로드되는 동안 대체 항목으로 표시할 로딩 UI를 생성 할 수 있음
* 정적인 컴포넌트들을 로딩 여부와 관계없이 화면에 그려짐 => 동적 콘텐츠가 로드되는 동안에도 상호작용 가능.
* 사용자는 다른 페이지로 이동하기 전에 페이지 로드를 기다릴 필요가 없음.*중단 가능한 탐색.

- 파일 시스템보다 높은 수준이므로 하위 디렉토리에 page.tsx 에도 적용.
- => 이를 거부하고 싶다면 (overview) 디렉토리를 생성 후 page.tsx와 loading.tsx를 폴더 내부로 이동.
- 경로 그룹 *()* 을 사용하면, URL 경로 구조에 영향을 주지 않고, 파일을 논리적 그룹으로 구성 할 수 있음
![[스크린샷 2023-11-09 14.35.01.png]]

- /dashboard/(overview)/page.tsx -> /dashboard/page.tsx 로 간주.


#### 지금 까지는 전체 페이지를 스트리밍, 대신 React Suspense를 사용하면 더욱 세분화되고 특정 컴포넌트에만 스트리밍을 적용 할 수 있음.

- Suspense를 사용하면 일부 요건이 충족 될 때까지, (예: 데이터 로드) 앱의 렌더링 부분을 연기 할 수 있음. 
- Suspense 에서 동적 컴포넌트를 wrapping 하여 동적 컴포넌트가 로드되는 동안 대체 구성요소를 출력.
- Suspense 컴포넌트로 타겟 동적 컴포넌트를 래핑하고, fallback 옵션에 대체 컴포넌트를 주입, 
- 타겟 동적 컴포넌트 내에서 fetch를 수행해, 해당 fetch가 완료 될때까지 대체 컴포넌트를 출력.

# 컴포넌트 그룹화.

- 카드 컴포넌트 4개가 각각 다른 api를 요청할 때, 
- 해당 카드들에 각각 Suspense를 적용할 시, 순차적으로 카드가 로딩되면서 레이아웃이 흔들리거나 동시에 로드되지 않는 현상이 있을 수 있는데,
- 해당 n개의 컴포넌트를 래핑하는 Wrapper 컴포넌트를 작성 후, 해당 Wrapper 컴포넌트에 Suspense를 적용하는 방법을 권장.


# Suspense 경계를 배치할 위치 결정.

- Suspense 경계를 배치하는 위치는 다음 몇가지 사항에 따라 달라짐.
	1. 페이지가 스트리밍될 때 사용자가 페이지를 경험하기를 원하는 방식.
	2. 어떤 콘텐츠에 우선순위를 두고 싶은지에 따라.
	3. 컴포넌트가 데이터 fetch에 의존하는 경우.
