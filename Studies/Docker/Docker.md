# 1. 컨테이너

- 격리된 공간에서 프로세스가 동작하는 기술
- 기존의 가상화 @> OS를 가상화 @> VMWare, VirtualBox 같은 가상머신 들은 호스트 OS 위에 게스트 OS 전체를 가상화하여 사용
	@> 여러가지 OS를 가상화 할 수 있고 비교적 사용법이 간단하지만, 무겁고 느리기 때문에 운영환경에서 사용하기 힘듬.
	
- CPU의 가상화 기술(HVM)을 이용한 KVM(*Kernel-based Virtual Machine*)관 반가상화(*Paravirtualization*) 방식의 Xen 등장
- 게스트 OS가 필요하긴 하지만 전체 OS를 가상화하지 않기 때문에, 호스트형 가상화에 비해 성능이 향상.
![[Pasted image 20240419140611.png]]

- 전가상화, 반가상화 둘 다 추가적인 OS를 설치하여 가상화 하는 방법은 성능에 문제를 야기하기 때문에, 프로세스를 격리하는 방식이 등장
- 이 방식을 리눅스에서는 리눅스 컨테이너라고 칭하며, 단순히 프로세스를 격리시키기 때문에 빠르게 동작하게 됨.
- CPU나 메모리는 딱 프로세스가 필요한만큼 추가로 사용하고 성능적으로도 손실이 미미함.
*도커의 기본 네트워크 모드는 ==Bridge== 모드로 약간의 성능 손실이 있음. 네트워크 성능이 중요한 프로그램의 경우 ==-net=host== 옵션을 고려해야 함.*

- 하나의 서버에 여러개의 컨테이너를 실행하면 서로 영향을 미치지 않고 독립적으로 실행되어 마치 가벼운 VM 을 사용하는 느낌.
- 실행중인 컨테이너에 접속하여 명령어를 입력할 수 있고, ==apt-get== 이나 ==yum== 으로 패키지를 설치할 수 있으며, 사용자도 추가하고 여러개의 프로세스를 백그라운드로 실행할수도 있음.
- CPU나 메모리 사용량을 제한할 수 있고, 호스트의 특정 포트와 연결하거나 호스트의 특정 디렉토리를 내부 디렉토리인 것처럼 사용할 수 있음.

- 도커가 등장하기 이전에, 프로세스를 격리하는 방법으로는 리눅스에서 cgroups(*control groups*)와 namespace를 이용한 LXC(*Linux Container*)가 있었고, FreeBSD에서는 ==Jail==, Solaris 에서는 ==Solaris Zones== 라는 기술이 있었음.
- 도커는 LXC를 기반으로 0.9버전에서 자체적인 ==libcontainer== 기술을 사용, 

![[Pasted image 20240419141633.png]]

- 도커의 가장 중요한 개념 @> ==컨테이너==, ==이미지==
- ==이미지== 는 ==컨테이너== 실행에 필요한 파일과 설정값들을 포함하고 있는 것. @> 상태값을 가지지 않고 불변성.
- ==컨테이너== @> 이미지를 실행한 상태. @> 추가되거나 변하는 값은 ==컨테이너==에 저장.
- 같은 ==이미지==에서 여러개의 ==컨테이너==를 생성할 수 있고, ==컨테이너==의 상태가 바뀌거나 ==컨테이너==가 삭제되더라도 이미지는 변하지 않고 유지됨.

- ubuntu ==이미지==는 ubuntu를 실행하기 위한 모든 파일을 가지고 있고, MySQL ==이미지==는 debian을 기반으로 MySQL을 실행하는데 필요한 파일과 실행 명령어, 포트 정보등을 가지고 있음.
- GitLab ==이미지==는 centos를 기반으로 ruby, go, database, redis, gitlab source, nginx 등을 가지고 있음.

- ==이미지==는 ==컨테이너==를 실행하기 위한 모든 정보를 가지고 있기 때문에, 추가로 의존성을 부여할 필요가 없음.
- 새로운 서버가 추가되면 만들어 놓은 이미지를 사용해 컨테이너를 생성 가능.